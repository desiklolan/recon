#!/usr/bin/env python3
import sys
import os
#import apt <- eventually script should install it's own tools with a prompt
#import subprocess <- things that can be done in parallel should be
from reconactions import *
from reconconfig import *

def main():
    if len(sys.argv) == 1:
        print("\nUsage: recon example.com\n")
        sys.exit(1)
    target = sys.argv[1]

    run_checks(amass_config)
    create_directory(target)

    print_bold_green("Running Amass to find sub-domains")
    run_amass(target, amass_config)

    print_bold_green("Running Assetfinder to find sub-domains")
    run_assetfinder(target, FB_APP_ID, FB_APP_SECRET, VT_API_KEY, SPYSE_API_TOKEN)

    print_green("Green")
    print_grey("Grey")
    print_red("Red")
    # Run amass
    # Run assetfinder
    # Run findomain
    # Run dnsbuffer
    # Run subfinder
    # remove duplicates
    # Run livehosts
    # Run GIT-Endpoints
    # Run Directory Bruteforce


if __name__ == '__main__':
    main()

'''
TODO:
* Add a domain regex check: ^(((?!-))(xn--|_{1,1})?[a-z0-9-]{0,61}[a-z0-9]{1,1}\.)*(xn--)?([a-z0-9][a-z0-9\-]{0,60}|[a-z0-9-]{1,30}\.[a-z]{2,})$
* Detect that assetfinder and other go modules have been installed

'''